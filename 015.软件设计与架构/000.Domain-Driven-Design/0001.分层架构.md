# 架构
## 分层
&nbsp;&nbsp; 在分层架构中，我们将领域模型和业务逻辑分离出来，并减少对基础设施、用户界面甚至应用层逻辑的依赖，因为他们不属于业务。将一个复杂的系统分为不同的层，每层都应该具有良好的内聚性，并且只依赖于比自身更低的层。
- <img src="../pics/2023-09-17_14-42-传统DDD-jiagou.png" style="width:500px;"/>

&nbsp;&nbsp;在这个传统的分层架构中，存在着一些与领域相关的挑战: 在分层架构中，领域层或多或少地需要使用基础设施层：
+ 资源库接口的实现需要基础设施层提供的持久化机制。那么，如果将资源库接口直接实现在基础设施层会怎样呢？由于基础设施层位于领域层之下，从基础设施层向上引用领域层则违反了分层架构的原则。遵从分层架构原则并不意味着领域对象需要需要与基础设施层发生直接耦合，此时可以采取模块的方式来隐藏技术实现细节。

## 依赖倒置原则
&nbsp;&nbsp;高层模块不应该依赖于低层模块，两者都应该依赖于抽象;抽象不应该依赖于细节，细节应该依赖于抽象 —— 依赖倒置原则.

&nbsp;&nbsp;根据该定义，低层服务(如基础设施层)应该依赖于高层组件(如用户界面层、应用层、领域层)所提供的接口。在架构中采用依赖倒置原则有很多种表达方式，如: 
- <img src="./../pics/2023-09-18_08-06-DDD-DIP_001.png" style="width:500px;"/>
  
  - 对于这种架构，我们可以在领域层中定义资源库接口，然后在基础设施层实现该接口。

&nbsp;&nbsp;开发时，应当将关注点放在领域层上，采用依赖倒置原则，使领域层和基础设施层都只依赖于由领域模型所定义的抽象接口。
> 当在分层架构中采用依赖倒置原则时，事实上已经不存在分层的概念了，无论是高层还是低层，他们都只依赖于抽象，好像是把架构推平了一样。如果将分层架构推平，再向其中加入一些对称性会变得如何?

##  六边形架构（端口与适配器）
&nbsp;&nbsp;在六边形架构中，不同的客户通过“平等”的方式与系统交互。需要新的客户时，只需要添加一个新的适配器将客户输入转化成能被系统API所理解的参数就行了。同时，系统输出，比如图形界面、持久化和消息等都可以通过不同方式实现，并且可以是互换的。这是可能的，因为对于每种特定的输出，都有一个新建的适配器负责完成相应的转化功能。
